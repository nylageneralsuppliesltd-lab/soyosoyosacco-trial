<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About Us | Soyosoyo SACCO</title>
    <meta name="description" content="From 1998 Medicare roots to modern financial empowerment. The full story of Soyosoyo SACCO.">
    <link rel="stylesheet" href="style.css?v=40">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        .history-section {
            margin: 80px 0;
            padding: 30px;
            background: #f8fdfa;
            border-radius: 24px;
            border: 2px solid #86efac;
            box-shadow: 0 15px 40px rgba(0,0,0,0.08);
            font-family: 'Lato', sans-serif;
        }
        .history-header {
            text-align: center;
            color: #004d1a;
            font-size: 2rem;
            font-weight: 900;
            margin-bottom: 20px;
        }
        .history-controls {
            text-align: center;
            margin: 20px 0;
            gap: 15px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        .btn {
            padding: 12px 28px;
            border: none;
            border-radius: 50px;
            font-weight: 900;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-save {
            background: #10B981;
            color: white;
        }
        .btn-save:hover { 
            background: #059669; 
            transform: translateY(-2px); 
        }
        .btn-download {
            background: #004d1a;
            color: white;
        }
        .btn-download:hover { 
            background: #166534; 
            transform: translateY(-2px); 
        }
        #fullHistoryTable {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        }
        #fullHistoryTable table {
            width: 100%;
            min-width: 800px; /* Desktop fit */
            border-collapse: collapse;
            background: white;
            table-layout: fixed; /* Ensures consistent column widths on desktop */
        }
        #fullHistoryTable th {
            background: #004d1a;
            color: white;
            padding: 16px 8px;
            text-align: center;
            font-weight: 900;
            font-size: 14px;
            white-space: nowrap;
        }
        #fullHistoryTable td {
            padding: 14px 8px;
            text-align: center;
            border-bottom: 1px solid #e6f4ea;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        #fullHistoryTable tr:hover {
            background: #fff8e1 !important;
        }
        #fullHistoryTable tr:nth-child(even) {
            background: #f0fdf4;
        }
        /* Right-align numeric columns for clarity */
        #fullHistoryTable td:nth-child(2),
        #fullHistoryTable td:nth-child(3),
        #fullHistoryTable td:nth-child(4),
        #fullHistoryTable td:nth-child(5),
        #fullHistoryTable td:nth-child(6) {
            text-align: right;
        }
        .history-footer {
            text-align: center;
            margin-top: 20px;
            color: #004d1a;
            font-weight: bold;
            font-size: 15px;
        }
        .current-month {
            background: #fff8e1 !important;
            font-weight: bold;
            box-shadow: inset 0 0 10px rgba(255,193,7,0.3);
        }
        /* MOBILE: Vertical stack - no horizontal scroll, full data flow */
        @media (max-width: 768px) {
            .history-section {
                padding: 20px;
                margin: 40px 0;
            }
            .history-header {
                font-size: 1.5rem;
            }
            .history-controls { 
                flex-direction: column; 
                align-items: center; 
            }
            .btn { 
                width: 90%; 
                max-width: 300px; 
            }
            #fullHistoryTable {
                overflow-x: hidden; /* Eliminate horizontal scroll */
            }
            #fullHistoryTable table {
                min-width: auto; /* Allow full width fit */
                font-size: 12px;
                border: 0;
            }
            #fullHistoryTable thead {
                display: none; /* Hide headers on mobile - data stacks naturally */
            }
            #fullHistoryTable tbody,
            #fullHistoryTable tr,
            #fullHistoryTable td {
                display: block;
                width: 100%;
            }
            #fullHistoryTable tr {
                margin-bottom: 12px;
                border: 1px solid #e6f4ea;
                border-radius: 12px;
                overflow: hidden;
                background: white;
                box-shadow: 0 2px 8px rgba(0,0,0,0.05);
                transition: transform 0.2s ease;
            }
            #fullHistoryTable tr:hover {
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            }
            #fullHistoryTable tr:nth-child(even) {
                background: #f0fdf4;
            }
            #fullHistoryTable tr.current-month {
                border-color: #fbbf24;
                box-shadow: inset 0 0 10px rgba(255,193,7,0.3), 0 2px 8px rgba(0,0,0,0.05);
            }
            #fullHistoryTable td {
                padding: 12px;
                text-align: left !important; /* Left-align for readability */
                border: none;
                border-bottom: 1px solid #f0f9f0;
                position: relative;
                font-size: 13px;
            }
            #fullHistoryTable td:before {
                content: attr(data-label) ": "; /* Pull header labels into cells */
                font-weight: bold;
                color: #004d1a;
                display: block;
                font-size: 11px;
                text-transform: uppercase;
                margin-bottom: 4px;
                letter-spacing: 0.5px;
            }
            #fullHistoryTable td:last-child {
                border-bottom: none;
            }
            /* Specific label overrides */
            #fullHistoryTable td:nth-of-type(1):before { content: "Period: "; }
            #fullHistoryTable td:nth-of-type(2):before { content: "Members: "; }
            #fullHistoryTable td:nth-of-type(3):before { content: "Contributions: "; }
            #fullHistoryTable td:nth-of-type(4):before { content: "Loans: "; }
            #fullHistoryTable td:nth-of-type(5):before { content: "Bank Balance: "; }
            #fullHistoryTable td:nth-of-type(6):before { content: "ROA: "; color: #10B981; }
            #fullHistoryTable td:nth-of-type(7):before { content: "Saved On: "; }
            #fullHistoryTable .ksh::before { content: "KSh " attr(data-value); display: inline; }
            #fullHistoryTable .roa::after { content: "%"; }
        }
        @media (max-width: 480px) {
            #fullHistoryTable td { padding: 10px; font-size: 12px; }
            #fullHistoryTable tr { margin-bottom: 10px; }
        }
    </style>
</head>
<body>

<header class="site-header">
    <div class="navbar">
        <a href="index.html"><img class="brand-logo round" src="assets/141dd3faa98da9737b591161deac509a.jpg" alt="Soyosoyo SACCO Logo"></a>
        <a href="https://chamasoft.com/login" class="member-portal">Member Portal</a>
        <button id="menu-toggle" aria-label="Toggle Menu"></button>
        <nav class="nav-links">
            <a href="index.html">Home</a>
            <a href="Products.html">Products</a>
            <a href="Online-Forms.html">Online Forms</a>
            <a href="Jobs.html">Jobs</a>
            <a href="Join-Us.html">Join Us</a>
        </nav>
    </div>
</header>

<main class="container">
    <section class="section">
        <h1 style="text-align: center; margin-bottom: 1.5rem;">The Evolution of Soyosoyo SACCO</h1>
        <p style="text-align: justify; margin: 15px 0;">
            Soyosoyo SACCO boasts a rich history, beginning its journey on <strong>July 15, 1998</strong>, as <strong>SOYOSOYO MEDICARE CO-OPERATIVE SAVINGS & CREDIT SOCIETY</strong>. Its initial, heartwarming mission was to pool funds and provide affordable credit, primarily to help members cover their families' medical bills.
        </p>
        <p style="text-align: justify; margin: 15px 0;">
            As the fund grew significantly, the SACCO's vision expanded beyond healthcare. It began to support members in financing their children's education, demonstrating its adaptability and commitment to community needs.
        </p>
        <p style="text-align: justify; margin: 15px 0;">
            However, with its membership spreading across various parts of the Kenyan Coast, the complexity of managing the SACCO, combined with the introduction of the National Hospital Insurance Fund (NHIF) which began covering medical bills, led the SACCO into a period of silence.
        </p>
        <p style="text-align: justify; margin: 15px 0;">
            But the story didn't end there. In 2022, the dedicated founding members reignited their passion, showing a keen interest in reviving the SACCO. Their goal was clear: to refresh its objectives to align with current community needs.
        </p>
        <p style="text-align: justify; margin: 15px 0;">
            This revival culminated in a new beginning for Soyosoyo SACCO. Officially rebranded and given a new look on April 10, 2024, it emerged with renewed vigor. Its expanded mission now focuses on providing affordable financing to cover a broader range of essential objectives, including medical bills, education, agriculture, and development.
        </p>
        <p style="text-align: justify; margin: 15px 0;">
            Soyosoyo SACCO stands today as a testament to its enduring commitment to its members, evolving to meet the diverse financial needs of its community.
        </p>
        <div style="text-align: center; margin-top: 2rem;">
            <a href="index.html" class="products-button">Back to Home</a>
        </div>
    </section>

    <!-- MONTHLY HISTORY SECTION — ENHANCED FOR CLEAR ALIGNMENT -->
    <section class="history-section">
        <h2 class="history-header">Monthly Financial History (2025 – Present)</h2>
        <div class="history-controls">
            <button class="btn btn-save" onclick="saveCurrentMonth()">
                SAVE THIS MONTH'S DATA
            </button>
            <button class="btn btn-download" onclick="downloadHistoryCSV()">
                DOWNLOAD FULL HISTORY (CSV)
            </button>
        </div>
        <div id="fullHistoryTable"></div>
        <div class="history-footer" id="historyFooter">
            Loading monthly records...
        </div>
    </section>
</main>

<footer>
    <p>© 2025–<span id="currentYear"></span> SOYOSOYO SACCO. All rights reserved. | <a href="mailto:info@soyosoyosacco.com">info@soyosoyosacco.com</a></p>
    <div class="social-icons">
        <a href="https://www.facebook.com/people/Soyosoyo-Sacco/61565783836766/" target="_blank" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
        <a href="https://x.com/SoyosoyoSACCO" target="_blank" aria-label="X (Twitter)"><i class="fab fa-x-twitter"></i></a>
        <a href="https://www.instagram.com/soyosoyosacco" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
    </div>
</footer>

<script>
  document.getElementById('currentYear').textContent = new Date().getFullYear();
</script>

<script>
  // FINAL: 100% SAFE, CAROUSEL-DRIVEN, NEON DB — KEEPS YOUR SCRIPT TAGS
  const API_BASE = 'https://soyosoyo-sacco-api.onrender.com/api';

  // Wait for carousel.js to finish loading and populate window.saccoData
  function waitForCarousel() {
    return new Promise((resolve) => {
      if (window.saccoData?.today) {
        resolve(window.saccoData.today);
        return;
      }
      const interval = setInterval(() => {
        if (window.saccoData?.today) {
        clearInterval(interval);
        resolve(window.saccoData.today);
        }
      }, 200);
      setTimeout(() => {
        clearInterval(interval);
        resolve(null);
      }, 12000); // 12s max wait
    });
  }

  // LOAD HISTORY FROM NEON DB
  async function loadLiveHistory() {
    try {
      const res = await fetch(`${API_BASE}/history`, { cache: 'no-store' });
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();

      window.saccoHistory = {};
      data.forEach(row => {
        window.saccoHistory[row.period] = {
          period: row.period,
          members: row.members,
          contributions: row.contributions,
          loans: row.loans,
          bankBalance: row.bankBalance,
          roa: row.roa,
          dateSaved: row.dateSaved
        };
      });

      renderFullHistory();

      const footer = document.getElementById('historyFooter');
      if (data.length === 0) {
        footer.innerHTML = "No data saved yet. Visit homepage → click <strong>SAVE</strong> to begin!";
      } else {
        footer.innerHTML = `
          <strong>${data.length}</strong> months saved in Neon DB 
          <span style="color:#10B981;">| Latest: ${data[0].period}</span>
          <span style="color:#004d1a;">| Live from carousel.js</span>
        `;
      }
    } catch (err) {
      console.warn('Neon DB offline', err);
      document.getElementById('historyFooter').textContent = "Offline — check internet connection";
      renderFullHistory();
    }
  }
    
<script src="scripts/main.js"></script>
<script src="scripts/carousel.js"></script>
    
  // SAVE CURRENT MONTH — ONLY FROM LIVE CAROUSEL
  async function saveCurrentMonth() {
    const today = await waitForCarousel();
    if (!today) {
      alert("Carousel not loaded!\nPlease visit homepage first and wait for numbers to appear.");
      return;
    }

    const payload = {
      members: today.members,
      contributions: today.contributions,
      loans: today.loans || 0,
      bank_balance: today.bankBalance || 0,
      roa: parseFloat(today.roa) || 0
    };

    try {
      const res = await fetch(`${API_BASE}/history/save`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      if (!res.ok) {
        const text = await res.text();
        throw new Error(text || res.status);
      }

      const result = await res.json();
      alert(`SAVED TO NEON DB!\nMonth: ${result.data.period}\nMembers: ${today.members.toLocaleString()}\nSource: carousel.js @ ${new Date().toLocaleString('en-KE')}`);
      loadLiveHistory();
    } catch (err) {
      console.error(err);
      alert("Save failed — check internet and try again.");
    }
  }

  // DOWNLOAD FROM NEON DB
  async function downloadHistoryCSV() {
    try {
      const res = await fetch(`${API_BASE}/history`);
      const data = await res.json();
      if (data.length === 0) {
        alert("No data to download yet.");
        return;
      }

      let csv = "Period,Members,Contributions,Loans,Bank Balance,ROA %,Saved On\n";
      data.sort((a, b) => a.period.localeCompare(b.period)).forEach(d => {
        csv += `${d.period},${d.members},${d.contributions},${d.loans},${d.bankBalance},${d.roa},${d.dateSaved}\n`;
      });

      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `Soyosoyo_SACCO_History_${new Date().getFullYear()}.csv`;
      a.click();
      URL.revokeObjectURL(url);
    } catch {
      alert("Download failed — check internet.");
    }
  }

  // AUTO LOAD WHEN PAGE OPENS
  document.addEventListener('DOMContentLoaded', () => {
    setTimeout(loadLiveHistory, 1000);
  });
</script>
    
<script>
  // AUTO-YEAR MAGIC — UPDATES EVERY YEAR TEXT AUTOMATICALLY
  document.addEventListener('DOMContentLoaded', () => {
    const currentYear = new Date().getFullYear();
    const startYear = 2025; // Change only if you want a different base year

    // Update copyright
    document.querySelectorAll('footer p').forEach(el => {
      if (el.textContent.includes('©')) {
        el.innerHTML = el.innerHTML.replace(/©\s*\d{4}–\d{4}/, `© ${startYear}–${currentYear}`);
        el.innerHTML = el.innerHTML.replace(/©\s*\d{4}/, `© ${currentYear}`);
      }
    });

    // Update history header
    document.querySelectorAll('.history-header').forEach(el => {
      if (el.textContent.includes('2025')) {
        el.textContent = el.textContent.replace('2025', currentYear);
      }
    });
  });
</script>


<script>
  // LOAD FROM LIVE NEON DB API
  async function loadLiveHistory() {
    try {
      const res = await fetch('https://soyosoyo-sacco-api.onrender.com/api/history');
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();

      window.saccoHistory = {};
      data.forEach(row => {
        window.saccoHistory[row.period] = {
          period: row.period,
          members: row.members,
          contributions: row.contributions,
          loans: row.loans,
          bankBalance: row.bankBalance,
          roa: row.roa,
          dateSaved: row.dateSaved
        };
      });
      renderFullHistory();
    } catch (err) {
      console.warn('Live API down → using localStorage fallback', err);
      loadPersistedData();
      renderFullHistory();
    }
  }

  // SAVE TO NEON DB
  async function saveCurrentMonth() {
    loadPersistedData();
    if (!window.saccoData?.today) {
      alert("No current data. Visit homepage first to load carousel metrics.");
      return;
    }

    const today = window.saccoData.today;
    const payload = {
      members: today.members,
      contributions: today.contributions,
      loans: today.loans || 0,
      bank_balance: today.bankBalance || 0,
      roa: parseFloat(today.roa) || 0
    };

    try {
      const res = await fetch('https://soyosoyo-sacco-api.onrender.com/api/history/save', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      if (!res.ok) {
        const text = await res.text();
        throw new Error(`HTTP ${res.status}: ${text}`);
      }

      const result = await res.json();
      alert(`SAVED TO NEON DB!\nMonth: ${result.data.period}\nMembers: ${today.members.toLocaleString()}`);
      loadLiveHistory();
    } catch (err) {
      console.error('Save error:', err);
      alert('SAVE FAILED — Open console (F12) → copy red error → send me');
    }
  }

  // Auto-load on page open
  document.addEventListener('DOMContentLoaded', loadLiveHistory);
</script>
</body>
</html>
